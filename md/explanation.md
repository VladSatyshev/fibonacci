### 1. Binary Exponentiation
[source](https://cp-algorithms.com/algebra/binary-exp.html)

**Цель**: Возведение в степень за $O(\log n)$.

**Идея**: 
1. Представить значение степени $n$ в бинарном виде. Длина двоичного представления равна $\lfloor\log_2{n}\rfloor + 1$.
2. Заметить, что за счет свойства степеней в худшем случае можно представить искомое значение как произведение из $\lfloor\log_2{n}\rfloor + 1$ чисел, т.е. $a^1 a^2 a^4 a^8 \cdots a^{2^{\lfloor\log_2{n}\rfloor}}$. Худший случай - когда двоичное представление содержит только единицы.
3. Заметить, что какждый последующий элемент в этом произведении вычисляется как квадрат предыдущего.

**Пример**: 
$$3^{13}=3^{1101_2}=3^{8+4+1}=3^8\cdot3^4\cdot3^1$$ 
При этом
$$3^1 = 3$$
$$3^2 = (3^1)^2$$
$$3^4 = (3^2)^2$$
$$3^8 = (3^4)^2$$

**Принцип алгоритма**:
На каждой итерации работаем с одним из элементов последовательности: $a^1 a^2 a^4 a^8 \cdots a^{2^{\lfloor\log_2{n}\rfloor}}$. Для вычисления элементов последовательности на каждой итерации вычисляем квадарт текущего множителя (`a *= a`). Перед переходом к следующему множетелю, проверяем, является ли текущий LSB двоичного представления `n` единицей (`n % 2 == 1`). Если является - добавляем множитель к ответу (`res *= a`). В конце тела цикла выполняем `n //= 2` - переход к следующему биту числа (`>>`).
```python
def exp(a: int, n: int) -> int:
    res = 1

    while n != 0:       
        if n % 2 == 1:
            res *= a
        a *= a
        n //= 2

    return res
```

Для реализации вычисления чисел Фибоначчи используется этот же алгоритм, но для возведения матриц 2x2 в степень `n-1` (см. п.2).

### 2. Фибоначчи через произведение матриц
```math
\begin{pmatrix}
f_{n}\\
f_{n-1}
\end{pmatrix}
=
\begin{pmatrix}
f_{n-1}+f_{n-2}\\
f_{n-1}+0
\end{pmatrix}
=
\begin{pmatrix}
1 & 1\\
1 & 0
\end{pmatrix}
\begin{pmatrix}
f_{n-1}\\
f_{n-2}
\end{pmatrix}
=
\begin{pmatrix}
1 & 1\\
1 & 0
\end{pmatrix}^2
\begin{pmatrix}
f_{n-2}\\
f_{n-3}
\end{pmatrix}
=
\cdots
=
\begin{pmatrix}
1 & 1\\
1 & 0
\end{pmatrix}^{n-1}
\begin{pmatrix}
f_{1}\\
f_{0}
\end{pmatrix}
=
\begin{pmatrix}
1 & 1\\
1 & 0
\end{pmatrix}^{n-1}
\begin{pmatrix}
1\\
0
\end{pmatrix}
```
Обозначим 
```math
M = \begin{pmatrix}
1 & 1\\
1 & 0
\end{pmatrix}^{n-1}$
```
и заметим, что $f_n = m_{00}$.

